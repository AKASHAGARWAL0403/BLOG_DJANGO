{% extends "base.html" %}
{% load crispy_forms_tags %}
{% block head_title %}

{{ instance.title }} | {{ block.super }}

{% endblock head_title %}


{% block content %}

<div class='col-sm-6 col-sm-offset-3'>
	{% if instance.image %}
		<img src='{{instance.image.url}}' class="img-responsive">
	{% endif %}
	<h1>{{ instance.title }}
		{% if instance.draft %}<span style="color:gray;font-size: 15px;margin-right: 15px">DRAFT</span>{% endif %}<small>{{ instance.publish }}</small></h1>
		
	{% if instance.user.get_full_name %}
		<p>AUTHOR:{{ instance.user.get_full_name }}</p>
	{% endif %}

<div class="fb-like" data-href="{{ request.build_absolute_uri }} data-layout="standard" data-action="like" data-size="small" data-show-faces="true" data-share="true"></div>

<br><br>

<div class='row'>
	<div class='col-sm-12 '>
		<div class="post-detail">{{ instance.get_markdown }}</div>
		<hr/>
		<br/>
		<div>
			<p class='lead'>Comments</p>
			<form method='POST' action='.'>{% csrf_token %}
				{{ form|crispy }}
				<input type='submit' class='btn btn-default' value='Comment' />	
			</form>
			<hr/>
			{% for comment in comments %}
	        <blockquote>
	        	<p>{{ comment.content }}</p>
				<footer>via {{ comment.user }} | {{ comment.timestamp|timesince }} ago</footer>
				{% for child in comment.children %}
					 <blockquote>
	        			<p>{{ child.content }}</p>
						<footer>via {{ child.user }} | {{ child.timestamp|timesince }} ago</footer>
					</blockquote>
				{% endfor %}
				<form method="POST" action="."> {% csrf_token %}
					{{ form|crispy }}
					<input type='hidden' name='parent_id' value='{{ comment.id }}'>
					<input type='submit' value='Reply' class='btn btn-default'>
				</form>
			</blockquote>
			<hr/>
			{% endfor %}
			</div>
	</div>
</div>
</div>

{% endblock content %}